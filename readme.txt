一、所有的财务数据：
举例（详见'所有财务数据.xlsx'）：
Key Financials USD
Revenue USD Mil                 24578.00  37491.00  42905.00  65225.00
Gross Margin %                     33.20     35.20     40.10     39.40
Operating Income USD Mil         4407.00   8327.00  11740.00  18385.00
Operating Margin %                 17.90     22.20     27.40     28.20
Net Income USD Mil               3495.00   6119.00   8235.00  14013.00
Earnings Per Share USD              0.56      0.97      1.30      2.16
Dividends USD                        NaN       NaN       NaN       NaN
Payout Ratio % *                     NaN       NaN       NaN       NaN
Shares Mil                       6225.00   6315.00   6349.00   6473.00
Book Value Per Share * USD          2.20      3.39      5.02      7.45
Operating Cash Flow USD Mil      5470.00   9596.00  10159.00  18595.00
Cap Spending USD Mil             -986.00  -1199.00  -1213.00  -2121.00
Free Cash Flow USD Mil           4484.00   8397.00   8946.00  16474.00
Free Cash Flow Per Share * USD      0.63      1.33      1.41      2.54
Working Capital USD Mil         12657.00  20598.00  20049.00  20956.00
Revenue                 100.00  100.00  100.00  100.00  100.00  100.00
COGS                     66.83   64.80   59.86   60.62   59.52   56.13
Gross Margin             33.17   35.20   40.14   39.38   40.48   43.87
SG&A                     12.06   10.03    9.67    8.46    7.02    6.42
R&D                       3.18    2.96    3.11    2.73    2.24    2.16
Other                      NaN     NaN     NaN     NaN     NaN     NaN
Operating Margin         17.93   22.21   27.36   28.19   31.22   35.30
Net Int Inc & Other       2.44    1.65    0.76    0.24    0.38    0.33
EBT Margin
Tax Rate %                    30.19  29.89  31.75  24.42  24.22  25.16
Net Margin %                  14.56  14.88  19.19  21.48  23.95  26.67
Asset Turnover (Average)       1.13   1.00   0.99   1.06   1.13   1.07
Return on Assets %            16.43  14.89  18.92  22.84  27.07  28.54
Financial Leverage (Average)   1.74   1.88   1.50   1.57   1.52   1.49
Return on Equity %            28.52  27.19  31.27  35.28  41.67  42.84
Return on Invested Capital %  24.84  27.19  30.22  34.69  41.04  42.01
Interest Coverage

Key Revenue %
Year over Year   24.29  35.30  32.10  52.02  65.96  44.58   9.20   6.95
3-Year Average   42.60  32.60  30.48  39.54  49.37  53.94  37.86  19.08
5-Year Average   33.12  39.23  38.97  36.17  41.16  45.49  39.39  33.63
10-Year Average

Key Operating Income %
Year over Year           79.74  42.32   87.09  56.60  83.79   63.48 -11.30
3-Year Average          138.25  56.09   68.52  60.96  75.28   67.57  38.65
5-Year Average          203.93    NaN  104.78  61.96  68.97   65.80  50.84
10-Year Average

Key Net Income %
Year over Year     75.77   38.27  70.36  70.16  84.99  60.99 -11.25   6.68
3-Year Average    133.11   53.56  60.57  58.85  75.03  71.77  38.26  15.08
5-Year Average    121.89  133.93  97.22  60.03  67.11  64.20  50.27  36.84
10-Year Average

Key EPS %
Year over Year    73.13   36.39  69.40  66.85  82.71  59.50  -9.97  13.58
3-Year Average   122.87   50.90  58.74  56.80  72.85  69.41  37.92  17.71
5-Year Average   112.83  124.02  91.24  57.56  64.90  62.22  49.29  37.82
10-Year Average

Key Cash Flow Ratios
Operating Cash Flow Growth % YOY  146.40  75.43   5.87  83.04  101.82  35.51
Free Cash Flow Growth % YOY       186.88  87.27   6.54  84.15   82.57  37.83
Cap Ex as a % of Sales              4.01   3.20   2.83   3.25    6.88   6.01
Free Cash Flow/Sales %             18.24  22.40  20.85  25.26   27.79  26.49
Free Cash Flow/Net Income

Key Balance Sheet Items (in %)
Cash & Short-Term Investments    60.70   61.89   49.40   34.08   22.30
Accounts Receivable              15.90   11.89   10.65   13.20   10.07
Inventory                         1.37    1.29    0.96    1.40    0.67
Other Current Assets              8.66   12.60    5.43    6.76    5.62
Total Current Assets             86.62   87.66   66.43   55.44   38.66
Net PP&E                          7.23    6.20    6.22    6.34    6.68
Intangibles                       1.66    1.24    1.18    1.44    3.81
Other Long-Term Assets            4.49    4.89   26.17   36.78   50.85
Total Assets                    100.00  100.00  100.00  100.00  100.00
Accounts Payable                 19.61   13.95   11.79   15.98   12.57
Short-Term Debt                    NaN     NaN     NaN     NaN     NaN
Taxes Payable                      NaN     NaN    0.91    0.28    0.98
Accrued Liabilities               4.97    9.40    7.20    6.45    6.97
Other Short-Term Liabilities     12.11   12.26    4.32    4.85    3.52
Total Current Liabilities        36.69   35.61   24.22   27.56   24.04
Long-Term Debt                     NaN     NaN     NaN     NaN     NaN
Other Long-Term Liabilities       5.98   11.25    9.17    8.87   10.13
Total Liabilities                42.67   46.86   33.39   36.43   34.16
Total Stockholders' Equity       57.33   53.14   66.61   63.57   65.84
Total Liabilities & Equity

Key Liquidity/Financial Health
Current Ratio                   2.36  2.46  2.74  2.01  1.61  1.50  1.68
Quick Ratio                     2.09  2.07  2.48  1.72  1.35  1.24  1.40
Financial Leverage              1.74  1.88  1.50  1.57  1.52  1.49  1.68
Debt/Equity

二、如果使用了数据库，保证已经创建了数据库即可。本程序自动添加table和column。

三、查询morningstar的数据需要提供ticker。可以借用另一个项目：
https://github.com/Benny-/Yahoo-ticker-symbol-downloader
python3.5
pip install Yahoo-ticker-downloader

usage: YahooTickerDownloader.py [-h] [-i] [-e] [-E EXCHANGE] [-s SLEEP] [-p]
                                [-m MARKET]
                                type

positional arguments:
  type                  The type to download, this can be: future mutualfund
                    etf stocks index currency

optional arguments:
  -h, --help            show this help message and exit
  -i, --insecure        use HTTP instead of HTTPS
  -e, --export          export immediately without downloading (Only useful if
                        you already downloaded something to the .pickle file)
  -E EXCHANGE, --Exchange EXCHANGE
                        Only export ticker symbols from this exchange (the
                        filtering is done during the export phase)
  -s SLEEP, --sleep SLEEP
                        The time to sleep in seconds between requests
  -p, --pandantic       Stop and warn the user if some rare assertion fails
  -m MARKET, --market MARKET
                        Specify the Region of queried exchanges (us =
                        USA+Canada, dr=Germany, fr=France, hk=Hongkong,
                        gb=United Kingdom, default= all)
例如：python YahooTickerDownloader.py -m us stocks

3. 美国与加拿大股市缩写
缩写          全名                     爬到公司数量
NYQ: New York Stock Exchange        3393 靠谱
ASE:  全美证券交易所       839 靠谱
BTS:  比特币      1
NCM:   NasdaqCM 纳斯达克资本市场     861
NGM:   纳斯达克全球市场     487
NMS：   纳斯达克全球精选      1775   完美世界在这里
OBB：  美国场外柜台交易系统      223
PCX:        36
PNK:   ?有多伦多股市     14405

4. 程序运行中，可以用ctrl+c终止，会自动记录下载到哪个股票。
再次运行时，从上次推出的位置开始。
5. 下载失败时：
把失败的记录放在not_download.csv中，然后继续下载下一个股票。

6. 操作数据库：
导出数据库：在程序安装目录的bin文件夹下面
MySQL Server 5.7\bin>mysqldump -u root -p morningstar > d:/work_mysql/morningstar0527.sql

导出数据库格式：
mysqldump -u dbuser -p -d --add-drop-table dbname >d:/dbname_db.sql
-d 没有数据 --add-drop-table 在每个create语句之前增加一个drop table，用来把具体的table删除。

导入数据库

上面可能不好使，用这个：
MySQL Server 5.7\bin>MySQL -u root -p mydb2 < e:\MySQL\mydb2.sql

读取数据库
mysql> select year_2017 from morningstar_income_statement where ticker = 'AAP' and item='Revenue';